<style>
  body {
    background-color: var(--figma-color-bg);
    font-family: Arial, Helvetica, sans-serif;
    margin: 16px;

    li {
      margin-top: 8px;
    }

    .header {
      color: #007aba;
    }
  }
</style>

<body>
  <h2 class="header">Zeta Icon Validator</h2>
  <div id="content"></div>
</body>


<script>
  const contentElementId = 'content';
  
  onmessage = (event) => {
    if (event.data.pluginMessage == 'clear') {
      document.getElementById(contentElementId).innerHTML = ''     
    } else {  
      const errors = event.data.pluginMessage;

      const errorContent = document.getElementById(contentElementId);
      
      if (errors.length == 0) {
        const validMessage = document.createElement('p');
        validMessage.textContent = 'All icon names are valid!'
        errorContent.appendChild(validMessage);
      } else {      
        const severeErrors = errors.filter((error) => error.severity == 2);
        const renameErrors = errors.filter((error) => error.severity == 1);
        
        if(severeErrors.length > 0) {
          errorContent.appendChild(createHeading('Invalid Icons'));
        }
        
        for (const error of severeErrors){
          errorContent.appendChild(createErrorElement(error));
        }
        
        if(renameErrors.length > 0) {
          errorContent.appendChild(createHeading('Renamed Icons'));
        }
        
        for (const error of renameErrors){
          errorContent.appendChild(createErrorElement(error));
        }
      }
    }
  }
  
  function createErrorElement(error) {
    const listItem = document.createElement("li");
    listItem.appendChild(document.createTextNode(error.message));

    return listItem;
  }

  function createHeading(message) {
    const heading = document.createElement("h3");
    heading.textContent = message;

    return heading;
  }
</script>
  